<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaflet Tutorial</title>
    <!-- leaflet css-->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

    <style>
        body{
            margin: 0;
            padding: 0;
        }
        #map {
            width:100%;
            height: 100vh;
        }
        .overlay-icon {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
            background: white;
            border: 1px solid #ccc;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.3);
        }
        .overlay-icon img {
            width: 30px;
            height: 30px;
        }
        .leaflet-control-layers {
            display: none;
        }
        /* Show the layer control when expanded */
        .leaflet-control-layers-expanded {
            display: block !important;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <!-- Custom overlay icon button -->
    <div class="overlay-icon" id="overlayIcon">
        <img src="img/layers.png" alt="Overlay Icon">
    </div>
</body>

<!-- leaflet js-->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

<!--leaflet routing machine js-->

<script>
    //Map initaialization
    var map = L.map('map').setView([11.0168, 76.9558], 10);

    //osm layer
    var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    });
    //osm.addTo(map);
    
    //TopPlusOpen Colour map
    var TopPlusOpen_Color = L.tileLayer('http://sgx.geodatenzentrum.de/wmts_topplus_open/tile/1.0.0/web/default/WEBMERCATOR/{z}/{y}/{x}.png', {
	    maxZoom: 18,
	    attribution: 'Map data: &copy; <a href="http://www.govdata.de/dl-de/by-2-0">dl-de/by-2-0</a>'
    });
    //TopPlusOpen_Color.addTo(map);

    //CartoDB.DarkMatter map
    var CartoDB_DarkMatter = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
	    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
	    subdomains: 'abcd',
	    maxZoom: 20
    });
    //CartoDB_DarkMatter.addTo(map);

    //Satellite view color map
    var AlidadeSatellite = L.tileLayer('https://tiles.stadiamaps.com/tiles/alidade_satellite/{z}/{x}/{y}{r}.{ext}', {
	    minZoom: 0,
	    maxZoom: 20,
	    attribution: '&copy; CNES, Distribution Airbus DS, © Airbus DS, © PlanetObserver (Contains Copernicus Data) | &copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a> &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
	    ext: 'jpg'
    });
    //AlidadeSatellite.addTo(map);

    //Google street map
        googleStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}',{
        maxZoom: 20,
        subdomains:['mt0','mt1','mt2','mt3']
    });
    googleStreets.addTo(map);

    //Google satellite view
    googleSat = L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',{
    maxZoom: 20,
    subdomains:['mt0','mt1','mt2','mt3']
    });
    //googleSat.addTo(map);

    //Marker

    //var singleMarker = L.marker([11.0168, 76.9558]).addTo(map);

        var myIcon = L.icon({
        iconUrl:'img/red_marker.png',
        iconSize: [40, 40],
    });
    var singleMarker = L.marker([11.0168, 76.9558], {icon: myIcon, draggable: true });
    
   // var singleMarker = L.marker([11.0168, 76.9558]);
    var popup = singleMarker.bindPopup('This is Coimbatore, TN.'+ singleMarker.getLatLng()).openPopup()
    popup.addTo(map);

    console.log(singleMarker.toGeoJSON())

    //Bundle of marker
   // Define markers with their respective coordinates and popups
    var salem = L.marker([11.6643, 78.1460]).bindPopup('This is Salem, TN.'),
        tiruchirappalli = L.marker([10.7905, 78.7047]).bindPopup('This is Tiruchirappalli, TN.'),
        chennai = L.marker([13.0843, 80.2705]).bindPopup('This is Chennai, TN.'),
        mumbai = L.marker([19.0760, 72.8777]).bindPopup('This is Mumbai, TN.');

    // Add all markers to a layer group
    var cities = L.layerGroup([salem, tiruchirappalli, chennai, mumbai]).addTo(map);

    
        //Layer controller
    var baseMaps = {
        "Open Street Map": osm,
        "TopPlusOpen_Color": TopPlusOpen_Color,
        "CartoDB_DarkMatter": CartoDB_DarkMatter,
        "AlidadeSatellite": AlidadeSatellite,
        "Google Streets": googleStreets ,
        "Google Satellite": googleSat 
    };

    var overlayMaps = {
        "Marker": singleMarker ,
        "Cities":cities
    };
    var layerControl=L.control.layers(baseMaps, overlayMaps,{collapsed: false }).addTo(map);

    //to remove layers
    // map.removeLayer(osm)
    var overlayIcon = document.getElementById('overlayIcon');
    overlayIcon.addEventListener('click', function () {
        var controlContainer = document.querySelector('.leaflet-control-layers');
        if (controlContainer.classList.contains('leaflet-control-layers-expanded')) {
            controlContainer.classList.remove('leaflet-control-layers-expanded');
        } else {
            controlContainer.classList.add('leaflet-control-layers-expanded');
        }
    });


   /* L.Routing.control({
        waypoints:[
            L.latLng( , ),
            L.latLng( , ),
        ]
    }).addTo(map);
    */
    var polygon = L.polygon([
    [51.509, -0.08],
    [51.503, -0.06],
    [51.51, -0.047]
]).addTo(map);

// Bind tooltip to the polygon
polygon.bindTooltip("This is a polygon").openTooltip();

</script>
</html>